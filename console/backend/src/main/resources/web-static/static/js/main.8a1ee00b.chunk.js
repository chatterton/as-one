(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{149:function(e){e.exports=[{x:30,y:5},{x:29,y:5},{x:28,y:5},{x:27,y:5},{x:27,y:6},{x:27,y:7},{x:27,y:8},{x:28,y:8},{x:29,y:8},{x:30,y:8},{x:30,y:7},{x:30,y:6},{x:30,y:4},{x:30,y:3},{x:30,y:2},{x:29,y:2},{x:28,y:2},{x:27,y:2},{x:27,y:3},{x:27,y:4},{x:25,y:5},{x:24,y:5},{x:23,y:5},{x:22,y:5},{x:22,y:6},{x:22,y:7},{x:22,y:8},{x:23,y:8},{x:24,y:8},{x:25,y:8},{x:25,y:7},{x:25,y:6},{x:25,y:4},{x:25,y:3},{x:25,y:2},{x:24,y:2},{x:23,y:2},{x:22,y:2},{x:22,y:3},{x:22,y:4},{x:20,y:2},{x:20,y:3},{x:20,y:4},{x:20,y:5},{x:20,y:6},{x:20,y:7},{x:20,y:8},{x:17,y:9},{x:16,y:9},{x:15,y:9},{x:14,y:9},{x:13,y:9},{x:13,y:8},{x:14,y:8},{x:15,y:8},{x:16,y:8},{x:17,y:8},{x:17,y:7},{x:16,y:7},{x:15,y:7},{x:14,y:7},{x:13,y:7},{x:18,y:2},{x:17,y:2},{x:16,y:2},{x:16,y:3},{x:16,y:4},{x:17,y:4},{x:18,y:4},{x:18,y:3},{x:18,y:1},{x:18,y:0},{x:17,y:0},{x:16,y:0},{x:16,y:1},{x:14,y:2},{x:13,y:2},{x:12,y:2},{x:12,y:3},{x:12,y:4},{x:13,y:4},{x:14,y:4},{x:14,y:3},{x:14,y:1},{x:14,y:0},{x:13,y:0},{x:12,y:0},{x:12,y:1},{x:10,y:5},{x:9,y:5},{x:8,y:5},{x:7,y:5},{x:7,y:6},{x:7,y:7},{x:7,y:8},{x:8,y:8},{x:9,y:8},{x:10,y:8},{x:10,y:7},{x:10,y:6},{x:10,y:4},{x:10,y:3},{x:10,y:2},{x:9,y:2},{x:8,y:2},{x:7,y:2},{x:7,y:3},{x:7,y:4},{x:5,y:5},{x:4,y:5},{x:3,y:5},{x:2,y:5},{x:2,y:6},{x:2,y:7},{x:2,y:8},{x:3,y:8},{x:4,y:8},{x:5,y:8},{x:5,y:7},{x:5,y:6},{x:5,y:4},{x:5,y:3},{x:5,y:2},{x:4,y:2},{x:3,y:2},{x:2,y:2},{x:2,y:3},{x:2,y:4},{x:0,y:2},{x:0,y:3},{x:0,y:4},{x:0,y:5},{x:0,y:6},{x:0,y:7},{x:0,y:8}]},232:function(e,t,a){e.exports=a(502)},236:function(e,t,a){},358:function(e,t){},360:function(e,t){},433:function(e,t){},434:function(e,t){},441:function(e,t,a){},501:function(e,t,a){},502:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(54),s=a.n(c),l=(a(236),a(10)),o=(a(237),a(13)),i=a.n(o),u=a(25),m=a(75),y=a(42),x=a.n(y),f={error:function(e){console.error(e)},log:function(e){console.log(e)}};var p=200;function d(){var e=Object(n.useState)(p),t=Object(l.a)(e,2),a=t[0],r=t[1],c=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],r=t[1];return[a,Object(n.useCallback)(function(e){function t(){null!==e&&r(e.getBoundingClientRect())}return window.addEventListener("resize",t),t(),function(){window.removeEventListener("resize",t)}},[])]}(),s=Object(l.a)(c,2),o=s[0],i=s[1];return Object(n.useEffect)(function(){var e=p;o&&(e=o.width),r(e)},[o,a]),[i,a,r]}var b=a(76),E=a(26),h=a(55),v=a.n(h),O=a(230),g=a.n(O),j=125;function w(e){var t=e.address,a=e.name,c=Object(n.useState)((new Date).valueOf()),s=Object(l.a)(c,2),o=s[0],y=s[1],x=Object(n.useState)(new g.a(300)),p=Object(l.a)(x,2),h=p[0],O=p[1],w=d(),k=Object(l.a)(w,2),S=k[0],_=k[1],N=Object(n.useState)(!1),P=Object(l.a)(N,2),C=P[0],B=P[1],L=Object(n.useState)(""),U=Object(l.a)(L,2),M=U[0],I=U[1],R=Object(n.useRef)([]).current;Object(m.a)(function(){O(function(e){return R.map(function(t){return e.push(t)}),e}),y((new Date).valueOf()),R.length=0},100),Object(n.useEffect)(function(){function e(){return(e=Object(u.a)(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=v.a.connect(t),e.prev=1,e.next=4,n.subscribe("asOne/sensor/reading");case 4:f.log("subscribed sensormonitor"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),f.error("error connecting to mqtt"),f.error(e.t0);case 11:return n.on("message",function(e,t){if(null!=t){var n=t.toString();if(n.startsWith(a)){var r=n.split(","),c=[parseInt(r[5]),r[1],r[2],r[3],r[4]];R.push(c),I(r[6])}}}),e.abrupt("return",function(){n.close&&n.close()});case 13:case"end":return e.stop()}},e,null,[[1,7]])}))).apply(this,arguments)}C||(!function(){e.apply(this,arguments)}(),B(!0))},[C,t,R,a,I]);var q=h.toArray(),A=q.length<2?1:q.map(function(e){return parseInt(e[1])+parseInt(e[2])+parseInt(e[3])+parseInt(e[4])}).reduce(function(e,t){return e+t}),T=q.length<2?1:A/q.length/4,D=new E.TimeSeries({name:"readings",columns:["time","s1","s2","s3","s4"],points:q}),W=new E.TimeRange(o-5e3,o);return r.a.createElement("div",{ref:S},null==D?"Loading ...":r.a.createElement(b.ChartContainer,{width:_,timeRange:W,title:M+": "+e.name},r.a.createElement(b.ChartRow,{height:_/3,showGrid:!0},r.a.createElement(b.YAxis,{id:"axis1",min:T-j,max:T+j,width:28,type:"linear",format:".0f"}),r.a.createElement(b.Charts,null,r.a.createElement(b.LineChart,{axis:"axis1",series:D,columns:["s1","s2","s3","s4"],style:{s1:{stroke:"#ff0000",opacity:.75},s2:{stroke:"#bbffbb",opacity:.75},s3:{stroke:"#00bbff",opacity:.75},s4:{stroke:"#bbbbbb",opacity:.75}}})))))}var k=a(29),S=a.n(k),_=a(11),N=a.n(_),P="/sensors";function C(e){var t=e.address,a=Object(n.useState)([]),c=Object(l.a)(a,2),s=c[0],o=c[1];function y(){return(y=Object(u.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.get(P);case 3:t=e.sent,o(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),f.error(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}return Object(m.a)(function(){!function(){y.apply(this,arguments)}()},1e3),r.a.createElement(S.a,null,Object.keys(s).map(function(e){return r.a.createElement(N.a,{lg:6,md:!0,key:e},r.a.createElement(w,{name:e,address:t}))}))}var B=a(37),L=a.n(B),U="/game/flipSensors";function M(){function e(){return(e=Object(u.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.post(U);case 3:t=e.sent,f.log("flipped sensor: "+t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),f.error(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}return r.a.createElement(S.a,null,r.a.createElement(N.a,{md:5,sm:0}),r.a.createElement(N.a,{sm:2},r.a.createElement(L.a,{className:"btn-block",style:{whiteSpace:"nowrap"},onPointerUp:function(){!function(){e.apply(this,arguments)}()}},"\u2196\ufe0f FLIP \u2197\ufe0f")),r.a.createElement(N.a,{md:5,sm:0}))}a(441);function I(e){var t=e.address,a=e.topic,c=e.emoji,s=Object(n.useState)(!1),o=Object(l.a)(s,2),y=o[0],x=o[1],p=Object(n.useState)(!1),d=Object(l.a)(p,2),b=d[0],E=d[1];return Object(n.useEffect)(function(){function e(){return(e=Object(u.a)(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=v.a.connect(t),e.prev=1,e.next=4,n.subscribe(a);case 4:f.log("subscribed mqttindicator "+c+" to topic "+a),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),f.error("error connecting to mqtt"),f.error(e.t0);case 11:n.on("message",function(){x(!0)});case 12:case"end":return e.stop()}},e,null,[[1,7]])}))).apply(this,arguments)}b||(!function(){e.apply(this,arguments)}(),E(!0))},[t,b,a,c]),Object(m.a)(function(){x(!1)},100),r.a.createElement("div",{className:y?"indicator-blink":"indicator"},r.a.createElement("span",{role:"img","aria-label":"MQTT"},c))}var R="/game/reset";function q(){function e(){return(e=Object(u.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.post(R);case 3:t=e.sent,f.log("reset effect: "+t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),f.error(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}return r.a.createElement(L.a,{label:"reset",id:"reset-button",onPointerUp:function(){!function(){e.apply(this,arguments)}()}},"reset")}function A(e){var t=e.address,a=Object(n.useState)(!1),c=Object(l.a)(a,2),s=c[0],o=c[1],m=Object(n.useState)(null),y=Object(l.a)(m,2),x=y[0],p=y[1],d=Object(n.useState)("169"),b=Object(l.a)(d,2),E=b[0],h=b[1];function O(e,t){var a=x;a&&a.publish&&a.publish(e,t)}return Object(n.useEffect)(function(){function e(){return(e=Object(u.a)(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.a.connect(t),e.prev=1,e.next=4,a.subscribe("asOne/console/leftBPM");case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),f.error("error connecting to mqtt"),f.error(e.t0);case 10:a.on("message",function(e,t){if(null!=t){var a=t.toString();a&&h(a)}}),p(a);case 12:case"end":return e.stop()}},e,null,[[1,6]])}))).apply(this,arguments)}s||(!function(){e.apply(this,arguments)}(),o(!0))},[t,x,s,h]),r.a.createElement(S.a,null,r.a.createElement(N.a,null,r.a.createElement(L.a,{label:"Upper",id:"upper-button",onPointerDown:function(){},onPointerUp:function(){O("asOne/fe/testUpper","500")}},"Upper ______")),r.a.createElement(N.a,null,r.a.createElement(L.a,{label:"Lower",id:"lower-button",onPointerUp:function(){O("asOne/fe/testLower","375")}},"Lower ______")),r.a.createElement(N.a,null,r.a.createElement(L.a,{label:"80 BPM",id:"80-bpm-button",onPointerUp:function(){O("asOne/fe/doBPM","80")}},"80 BPM ______")),r.a.createElement(N.a,null,r.a.createElement(L.a,{label:"Left BPM",id:"left-bpm-button",onPointerUp:function(){O("asOne/fe/doBPM",E)}},"Left BPM (",E,")")),r.a.createElement(N.a,null,r.a.createElement(q,null)),r.a.createElement(N.a,null))}var T=a(88),D=a(149),W=31,z=10,F="#222222";function J(e){var t=e.address,a=Object(n.useState)(!1),c=Object(l.a)(a,2),s=c[0],o=c[1],m=Object(n.useState)([]),y=Object(l.a)(m,2),x=y[0],p=y[1],b=Object(n.useState)([]),E=Object(l.a)(b,2),h=E[0],O=E[1],g=d(),j=Object(l.a)(g,2),w=j[0],k=j[1];function S(e,t){return"key_"+e+"_"+t}function _(e){return e/W}return Object(n.useEffect)(function(){function e(){return(e=Object(u.a)(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.a.connect(t),e.prev=1,e.next=4,a.subscribe("asOne/score/all/direct");case 4:f.log("subscribed scoreboardemulator"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),f.error("error connecting to mqtt"),f.error(e.t0);case 11:a.on("message",function(e,t){p(t)});case 12:case"end":return e.stop()}},e,null,[[1,7]])}))).apply(this,arguments)}s||(!function(){e.apply(this,arguments)}(),o(!0))},[s,t]),Object(n.useEffect)(function(){if(x){for(var e=[],t=0;t<x.length;t+=3){if((x[t]+x[t+1]+x[t+2])/765>.1){var a=(c=x[t],s=x[t+1],l=x[t+2],"#"+((1<<24)+(c<<16)+(s<<8)+l).toString(16).slice(1));e.push(a)}else e.push(F)}var n=_(k);e.map(function(e,t){var a=D[t].x,c=D[t].y,s=r.a.createElement(T.Rect,{x:n*a,y:n*c,width:n,height:n,fill:e,key:S(a,c)});return h[a][c]=s,e}),O(h)}var c,s,l},[x,h,k]),Object(n.useEffect)(function(){for(var e=_(k),t=[],a=0;a<W;a++){for(var n=[],c=0;c<z;c++){var s=r.a.createElement(T.Rect,{x:e*a,y:e*c,width:e,height:e,fill:F,key:S(a,c)});n.push(s)}t.push(n)}O(t)},[k]),r.a.createElement("div",{ref:w},r.a.createElement(T.Stage,{width:k,height:k/3},r.a.createElement(T.Layer,null,h.flat())))}var G="/game/fire";function H(){function e(){return(e=Object(u.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.post(G);case 3:t=e.sent,f.log("fired effect: "+t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),f.error(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}return r.a.createElement(L.a,{label:"fire",style:{width:"200px"},id:"fire-button",onPointerUp:function(){!function(){e.apply(this,arguments)}()}},"\xa0\xa0\xa0\xa0\xa0f\xa0i\xa0r\xa0e\xa0\xa0\xa0\xa0\xa0")}var Q=a(231),Y=a.n(Q),$=a(150),K=a.n($),V=a(108),X=a.n(V),Z="ws://"+window.location.hostname+":8181";var ee=function(){var e=Object(n.useState)(!0),t=Object(l.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(!0),o=Object(l.a)(s,2),i=o[0],u=o[1],m=r.a.createElement(S.a,{style:{height:"40px"}});return r.a.createElement("div",{className:"App"},r.a.createElement(Y.a,{fluid:"true"},r.a.createElement(S.a,null,r.a.createElement(N.a,{md:0,lg:1}),r.a.createElement(N.a,{md:12,lg:10},r.a.createElement(K.a,{expand:"lg",variant:"dark",bg:"dark"},r.a.createElement(K.a.Brand,{href:"#"},"As One"),r.a.createElement("div",{className:"d-flex ml-auto flex-nowrap"},r.a.createElement(I,{address:Z,topic:"asOne/fe/heartbeat",emoji:"\ud83d\udd25"}),r.a.createElement("div",{style:{width:"10px"}}),r.a.createElement(I,{address:Z,topic:"asOne/score/heartbeat",emoji:"\ud83d\udcfa"}),r.a.createElement("div",{style:{width:"10px"}}),r.a.createElement(I,{address:Z,topic:"asOne/#",emoji:"\ud83d\udce2"})))),r.a.createElement(N.a,{md:0,lg:1})),m,r.a.createElement(S.a,null,r.a.createElement(N.a,{md:0,lg:1}),r.a.createElement(N.a,{md:12,lg:10},r.a.createElement(H,null)),r.a.createElement(N.a,{md:0,lg:1})),m,r.a.createElement(S.a,null,r.a.createElement(N.a,{md:0,lg:1}),r.a.createElement(N.a,null,r.a.createElement("div",{className:"card",style:{backgroundColor:F}},r.a.createElement("h4",{className:"card-header"},r.a.createElement("a",{href:"#/",onClick:function(){return u(!i)}},"Handsets",r.a.createElement("span",{className:"float-right"},"\u25bc"))),r.a.createElement(X.a,{in:i},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"card-text"},r.a.createElement(C,{address:Z}),m,r.a.createElement(M,null)))))),r.a.createElement(N.a,{md:0,lg:1})),m,r.a.createElement(S.a,null,r.a.createElement(N.a,{md:0,lg:1}),r.a.createElement(N.a,null,r.a.createElement("div",{className:"card",style:{backgroundColor:F}},r.a.createElement("h4",{className:"card-header"},r.a.createElement("a",{href:"#/",onClick:function(){return c(!a)}},"Scoreboard",r.a.createElement("span",{className:"float-right"},"\u25bc"))),r.a.createElement(X.a,{in:a},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"card-text"},r.a.createElement(J,{address:Z})))))),r.a.createElement(N.a,{md:0,lg:1})),m,r.a.createElement(S.a,null,r.a.createElement(N.a,{md:0,lg:1}),r.a.createElement(N.a,null,r.a.createElement("div",{className:"card",style:{backgroundColor:F}},r.a.createElement("h4",{className:"card-header"},"Fire"),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"card-text"},r.a.createElement(A,{address:Z}))))),r.a.createElement(N.a,{md:0,lg:1})),m))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(501);s.a.render(r.a.createElement(ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[232,1,2]]]);
//# sourceMappingURL=main.8a1ee00b.chunk.js.map